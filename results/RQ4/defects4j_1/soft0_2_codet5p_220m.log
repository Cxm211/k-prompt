Namespace(log_name='./RQ5/defects4j_1/soft0_2_codet5p_220m.log', model_name='Salesforce/codet5p-220m', lang='java', output_dir='RQ5/defects4j_1/soft0_2_codet5p_220m', data_dir='./data/RQ5/defects4j_1_2', no_cuda=False, visible_gpu='0', num_train_epochs=10, num_test_epochs=1, train_batch_size=4, eval_batch_size=2, gradient_accumulation_steps=1, load_model_path=None, config_name='', tokenizer_name='', max_source_length=512, max_target_length=512, warm_up_ratio=0.1, do_train=True, do_eval=True, do_test=True, freeze=False, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, local_rank=-1, seed=42, early_stop_threshold=3)
Process rank: -1, device: cuda, n_gpu: 1, distributed training: False
Model created!!
[[{'text': 'public static String join(Object[] array, String separator, int startIndex, int              return EMPTY;          }         StringBuilder buf = new StringBuilder((array[startIndex] == null ? 16 : array[startIndex].toString().length()) + separator.length());          for (int i = startIndex; i < endIndex; i++) {              if (i > startIndex) {', 'loss_ids': 0, 'shortenable_ids': 1}, {'text': '<mask>', 'loss_ids': 1, 'shortenable_ids': 0}, {'text': '', 'loss_ids': 0, 'shortenable_ids': 0}], {'guid': 0, 'tgt_text': 'public static String join(Object[] array, String separator, int startIndex, int              return EMPTY;          }         StringBuilder buf = new StringBuilder(noOfItems * 16);          for (int i = startIndex; i < endIndex; i++) {              if (i > startIndex) {'}]
***** Running training *****
  Num examples = 1
  Batch size = 4
  Num epoch = 10

***** Running evaluation *****
  Num examples = 64
  Batch size = 2
  epoch = 0
  eval_ppl = inf
  global_step = 2
  train_loss = 89.166
  ********************
Previous best ppl:inf
Achieve Best ppl:inf
  ********************
BLEU file: ./data/RQ5/defects4j_1_2/validation.jsonl
  codebleu-4 = 15.24 	 Previous best codebleu 0
  ********************
 Achieve Best bleu:15.24
  ********************

***** Running evaluation *****
  Num examples = 64
  Batch size = 2
  epoch = 1
  eval_ppl = inf
  global_step = 3
  train_loss = 101.2986
  ********************
Previous best ppl:inf
Achieve Best ppl:inf
  ********************
BLEU file: ./data/RQ5/defects4j_1_2/validation.jsonl
  codebleu-4 = 24.67 	 Previous best codebleu 15.24
  ********************
 Achieve Best bleu:24.67
  ********************

***** Running evaluation *****
  Num examples = 64
  Batch size = 2
  epoch = 2
  eval_ppl = inf
  global_step = 4
  train_loss = 42.7161
  ********************
Previous best ppl:inf
Achieve Best ppl:inf
  ********************
BLEU file: ./data/RQ5/defects4j_1_2/validation.jsonl
  codebleu-4 = 26.77 	 Previous best codebleu 24.67
  ********************
 Achieve Best bleu:26.77
  ********************

***** Running evaluation *****
  Num examples = 64
  Batch size = 2
  epoch = 3
  eval_ppl = inf
  global_step = 5
  train_loss = 34.2905
  ********************
Previous best ppl:inf
Achieve Best ppl:inf
  ********************
BLEU file: ./data/RQ5/defects4j_1_2/validation.jsonl
  codebleu-4 = 31.18 	 Previous best codebleu 26.77
  ********************
 Achieve Best bleu:31.18
  ********************

***** Running evaluation *****
  Num examples = 64
  Batch size = 2
  epoch = 4
  eval_ppl = inf
  global_step = 6
  train_loss = 25.8312
  ********************
Previous best ppl:inf
BLEU file: ./data/RQ5/defects4j_1_2/validation.jsonl
  codebleu-4 = 31.45 	 Previous best codebleu 31.18
  ********************
 Achieve Best bleu:31.45
  ********************

***** Running evaluation *****
  Num examples = 64
  Batch size = 2
  epoch = 5
  eval_ppl = inf
  global_step = 7
  train_loss = 20.7079
  ********************
Previous best ppl:inf
BLEU file: ./data/RQ5/defects4j_1_2/validation.jsonl
  codebleu-4 = 30.78 	 Previous best codebleu 31.45
  ********************

***** Running evaluation *****
  Num examples = 64
  Batch size = 2
  epoch = 6
  eval_ppl = inf
  global_step = 8
  train_loss = 14.8997
  ********************
Previous best ppl:inf
BLEU file: ./data/RQ5/defects4j_1_2/validation.jsonl
  codebleu-4 = 30.81 	 Previous best codebleu 31.45
  ********************

***** Running evaluation *****
  Num examples = 64
  Batch size = 2
  epoch = 7
  eval_ppl = inf
  global_step = 9
  train_loss = 14.4471
  ********************
Previous best ppl:inf
BLEU file: ./data/RQ5/defects4j_1_2/validation.jsonl
  codebleu-4 = 30.48 	 Previous best codebleu 31.45
  ********************
early stopping!!!
reload model from RQ5/defects4j_1/soft0_2_codet5p_220m/checkpoint-best-bleu
BLEU file: ./data/RQ5/defects4j_1_2/test.jsonl
  codebleu = 30.23 
  Total = 64 
  Exact Fixed = 0 
[]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  ********************
  Total = 64 
  Exact Fixed = 0 
[]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  codebleu = 30.23 
[0.24893156270200803, 0.26635428059828237, 0.28675833999344535, 0.1412646916288194, 0.28012347384926917, 0.5368565191169725, 0.18412736864268964, 0.3791712472675894, 0.10644999150096633, 0.5667016462281982, 0.5879579727568617, 0.2815530679787405, 0.3600785673594245, 0.25409539769457895, 0.16656858412009645, 0.22261269624074323, 0.22638363366049088, 0.2613742537287364, 0.43633363924363644, 0.37676328725139885, 0.3100338344646056, 0.12660272751199697, 0.35094725733220666, 0.26743223389055565, 0.22481196175704982, 0.22989260053280489, 0.46996129348092897, 0.6183299698673199, 0.3219627329473068, 0.2670862801624393, 0.2857450649626071, 0.29353738208832775, 0.29444451446842074, 0.29444451446842074, 0.30223856393278514, 0.12807821672721864, 0.47008489392777425, 0.15307686802425213, 0.404218888108356, 0.26607732652891813, 0.448099556009102, 0.3097330005367794, 0.1891478866308921, 0.25140371286912316, 0.2925973234094481, 0.3349621744745349, 0.2995009153346124, 0.15165451011263348, 0.1783018619201933, 0.3089524835864189, 0.3373544487096865, 0.2951865537830243, 0.31295959155220854, 0.3561865086229311, 0.277013649550641, 0.6038203809671508, 0.24808123503915286, 0.45840477244799227, 0.19170162814007424, 0.21376080052541155, 0.3208990837342517, 0.246890846370353, 0.2837955854192531, 0.18566966672023993]
Finish training and take 37m
