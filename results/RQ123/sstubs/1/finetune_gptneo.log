Namespace(log_name='./sstubs/1/finetune_gptneo.log', model_name='EleutherAI/gpt-neo-1.3B', lang='java', output_dir='sstubs/1/finetune_gptneo', data_dir='./data/sstubs/1', no_cuda=False, visible_gpu='0', add_task_prefix=False, add_lang_ids=False, num_train_epochs=10, num_test_epochs=10, train_batch_size=8, eval_batch_size=4, gradient_accumulation_steps=2, load_model_path=None, config_name='', tokenizer_name='', max_source_length=512, max_target_length=512, warm_up_ratio=0.1, do_train=True, do_eval=True, do_test=True, do_lower_case=False, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, eval_steps=-1, train_steps=-1, local_rank=-1, seed=42, early_stop_threshold=3)
Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, model_name: EleutherAI/gpt-neo-1.3B
model created!
Total 260 training instances 
***** Running training *****
  Num examples = 260
  Batch size = 8
  Num epoch = 10

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 0
  eval_ppl = 1.00639
  global_step = 33
  train_loss = 3.7898
  ********************
Previous best ppl:inf
Achieve Best ppl:1.00639
  ********************
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 91.13 	 Previous best codebleu 0
  ********************
 Achieve Best bleu:91.13
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 1
  eval_ppl = 1.00496
  global_step = 65
  train_loss = 1.7005
  ********************
Previous best ppl:1.00639
Achieve Best ppl:1.00496
  ********************
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 88.13 	 Previous best codebleu 91.13
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 2
  eval_ppl = 1.00497
  global_step = 97
  train_loss = 0.9341
  ********************
Previous best ppl:1.00496
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 88.98 	 Previous best codebleu 91.13
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 3
  eval_ppl = 1.00543
  global_step = 129
  train_loss = 0.5474
  ********************
Previous best ppl:1.00496
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 85.4 	 Previous best codebleu 91.13
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 4
  eval_ppl = 1.00571
  global_step = 161
  train_loss = 0.3727
  ********************
Previous best ppl:1.00496
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 87.83 	 Previous best codebleu 91.13
  ********************
reload model from sstubs/1/finetune_gptneo/checkpoint-best-bleu
BLEU file: ./data/sstubs/1/test.jsonl
  codebleu = 90.61 
  Total = 32 
  Exact Fixed = 0 
[]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  ********************
  Total = 32 
  Exact Fixed = 0 
[]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  codebleu = 90.61 
[0.8824709043482357, 0.9370576952964131, 0.940387748772268, 0.8700625454538655, 0.9493239030379825, 0.9272945586059962, 0.7187109450998381, 0.9468301376782615, 0.9042101507130247, 0.939529666001018, 0.9383022364276514, 0.8107613352737074, 0.6772264301009557, 0.9259520853518541, 0.940084905673596, 0.9217146126934004, 0.9372561368734473, 0.9136815104017959, 0.889134255278525, 0.7016265496309229, 0.9493239030379825, 0.9217146126934004, 0.8748733743967635, 0.9616102999368312, 0.9368020958482046, 0.940084905673596, 0.9289542494919141, 0.9514967635709539, 0.9616102999368312, 0.9636834829996033, 0.966410184624177, 0.966410184624177]
Finish training and take 15m
