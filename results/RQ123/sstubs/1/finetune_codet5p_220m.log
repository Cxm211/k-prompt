Namespace(log_name='./sstubs/1/finetune_codet5p_220m.log', model_name='Salesforce/codet5p-220m', lang='java', output_dir='sstubs/1/finetune_codet5p_220m', data_dir='./data/sstubs/1', no_cuda=False, visible_gpu='0', add_task_prefix=False, add_lang_ids=False, num_train_epochs=10, num_test_epochs=10, train_batch_size=8, eval_batch_size=4, gradient_accumulation_steps=2, load_model_path=None, config_name='', tokenizer_name='', max_source_length=128, max_target_length=128, warm_up_ratio=0.1, do_train=True, do_eval=True, do_test=True, do_lower_case=False, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, eval_steps=-1, train_steps=-1, local_rank=-1, seed=42, early_stop_threshold=3)
Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, model_name: Salesforce/codet5p-220m
model created!
Total 223 training instances 
***** Running training *****
  Num examples = 223
  Batch size = 8
  Num epoch = 10

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 0
  eval_ppl = 1.00068
  global_step = 29
  train_loss = 0.5279
  ********************
Previous best ppl:inf
Achieve Best ppl:1.00068
  ********************
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 92.98 	 Previous best codebleu 0
  ********************
 Achieve Best bleu:92.98
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 1
  eval_ppl = 1.00042
  global_step = 57
  train_loss = 0.1159
  ********************
Previous best ppl:1.00068
Achieve Best ppl:1.00042
  ********************
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 94.4 	 Previous best codebleu 92.98
  ********************
 Achieve Best bleu:94.4
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 2
  eval_ppl = 1.00041
  global_step = 85
  train_loss = 0.0689
  ********************
Previous best ppl:1.00042
Achieve Best ppl:1.00041
  ********************
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 94.4 	 Previous best codebleu 94.4
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 3
  eval_ppl = 1.00037
  global_step = 113
  train_loss = 0.038
  ********************
Previous best ppl:1.00041
Achieve Best ppl:1.00037
  ********************
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 93.49 	 Previous best codebleu 94.4
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 4
  eval_ppl = 1.00039
  global_step = 141
  train_loss = 0.0269
  ********************
Previous best ppl:1.00037
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 93.49 	 Previous best codebleu 94.4
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 5
  eval_ppl = 1.0004
  global_step = 169
  train_loss = 0.0197
  ********************
Previous best ppl:1.00037
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 93.23 	 Previous best codebleu 94.4
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 6
  eval_ppl = 1.00039
  global_step = 197
  train_loss = 0.0171
  ********************
Previous best ppl:1.00037
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 93.23 	 Previous best codebleu 94.4
  ********************
reload model from sstubs/1/finetune_codet5p_220m/checkpoint-best-bleu
BLEU file: ./data/sstubs/1/test.jsonl
  codebleu = 95.33 
  Total = 27 
  Exact Fixed = 12 
[1, 4, 5, 6, 9, 12, 13, 20, 21, 24, 26, 27]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  ********************
  Total = 27 
  Exact Fixed = 12 
[1, 4, 5, 6, 9, 12, 13, 20, 21, 24, 26, 27]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  codebleu = 95.33 
[1.0, 0.9245037448286011, 0.9056583090096291, 1.0, 1.0, 1.0, 0.9523104352365284, 0.9315722311515438, 1.0, 0.9406018863753673, 0.8910871854638854, 1.0, 1.0, 0.8158463815378669, 0.9136815104017959, 0.973200733636699, 0.8852005472381914, 0.9188441984944269, 0.8955980328281301, 1.0, 1.0, 0.9439975336408695, 0.9120033353993269, 1.0, 0.9339261075829457, 1.0, 1.0]
Finish training and take 2m
Namespace(log_name='./sstubs/1/finetune_codet5p_220m.log', model_name='Salesforce/codet5p-220m', lang='java', output_dir='sstubs/2/finetune_codet5p_220m', data_dir='./data/sstubs/2', no_cuda=False, visible_gpu='0', add_task_prefix=False, add_lang_ids=False, num_train_epochs=10, num_test_epochs=10, train_batch_size=8, eval_batch_size=4, gradient_accumulation_steps=2, load_model_path=None, config_name='', tokenizer_name='', max_source_length=128, max_target_length=128, warm_up_ratio=0.1, do_train=True, do_eval=True, do_test=True, do_lower_case=False, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, eval_steps=-1, train_steps=-1, local_rank=-1, seed=42, early_stop_threshold=3)
Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, model_name: Salesforce/codet5p-220m
model created!
Total 223 training instances 
***** Running training *****
  Num examples = 223
  Batch size = 8
  Num epoch = 10

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 0
  eval_ppl = 1.00063
  global_step = 29
  train_loss = 0.5225
  ********************
Previous best ppl:inf
Achieve Best ppl:1.00063
  ********************
BLEU file: ./data/sstubs/2/validation.jsonl
  codebleu-4 = 92.15 	 Previous best codebleu 0
  ********************
 Achieve Best bleu:92.15
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 1
  eval_ppl = 1.00043
  global_step = 57
  train_loss = 0.1135
  ********************
Previous best ppl:1.00063
Achieve Best ppl:1.00043
  ********************
BLEU file: ./data/sstubs/2/validation.jsonl
  codebleu-4 = 95.65 	 Previous best codebleu 92.15
  ********************
 Achieve Best bleu:95.65
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 2
  eval_ppl = 1.00036
  global_step = 85
  train_loss = 0.0588
  ********************
Previous best ppl:1.00043
Achieve Best ppl:1.00036
  ********************
BLEU file: ./data/sstubs/2/validation.jsonl
  codebleu-4 = 95.78 	 Previous best codebleu 95.65
  ********************
 Achieve Best bleu:95.78
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 3
  eval_ppl = 1.00038
  global_step = 113
  train_loss = 0.0357
  ********************
Previous best ppl:1.00036
BLEU file: ./data/sstubs/2/validation.jsonl
  codebleu-4 = 95.83 	 Previous best codebleu 95.78
  ********************
 Achieve Best bleu:95.83
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 4
  eval_ppl = 1.00039
  global_step = 141
  train_loss = 0.0214
  ********************
Previous best ppl:1.00036
BLEU file: ./data/sstubs/2/validation.jsonl
  codebleu-4 = 96.21 	 Previous best codebleu 95.83
  ********************
 Achieve Best bleu:96.21
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 5
  eval_ppl = 1.0004
  global_step = 169
  train_loss = 0.0149
  ********************
Previous best ppl:1.00036
BLEU file: ./data/sstubs/2/validation.jsonl
  codebleu-4 = 95.79 	 Previous best codebleu 96.21
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 6
  eval_ppl = 1.00042
  global_step = 197
  train_loss = 0.0134
  ********************
Previous best ppl:1.00036
BLEU file: ./data/sstubs/2/validation.jsonl
  codebleu-4 = 95.14 	 Previous best codebleu 96.21
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 7
  eval_ppl = 1.00041
  global_step = 225
  train_loss = 0.0103
  ********************
Previous best ppl:1.00036
BLEU file: ./data/sstubs/2/validation.jsonl
  codebleu-4 = 96.09 	 Previous best codebleu 96.21
  ********************
reload model from sstubs/2/finetune_codet5p_220m/checkpoint-best-bleu
BLEU file: ./data/sstubs/2/test.jsonl
  codebleu = 94.72 
  Total = 27 
  Exact Fixed = 16 
[1, 3, 4, 5, 6, 7, 9, 10, 11, 13, 14, 19, 21, 22, 24, 26]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  ********************
  Total = 27 
  Exact Fixed = 16 
[1, 3, 4, 5, 6, 7, 9, 10, 11, 13, 14, 19, 21, 22, 24, 26]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  codebleu = 94.72 
[1.0, 0.9261420415269246, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9007008806729067, 1.0, 1.0, 1.0, 0.6925131239952165, 1.0, 1.0, 0.9495565333799167, 0.8947836446510709, 0.9601466755014141, 0.9325400085710811, 1.0, 0.9517918920357142, 1.0, 1.0, 0.5816985005416719, 1.0, 0.8658230311280162, 1.0, 0.9179855428506689]
Finish training and take 3m
Namespace(log_name='./sstubs/1/finetune_codet5p_220m.log', model_name='Salesforce/codet5p-220m', lang='java', output_dir='sstubs/3/finetune_codet5p_220m', data_dir='./data/sstubs/3', no_cuda=False, visible_gpu='0', add_task_prefix=False, add_lang_ids=False, num_train_epochs=10, num_test_epochs=10, train_batch_size=8, eval_batch_size=4, gradient_accumulation_steps=2, load_model_path=None, config_name='', tokenizer_name='', max_source_length=128, max_target_length=128, warm_up_ratio=0.1, do_train=True, do_eval=True, do_test=True, do_lower_case=False, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, eval_steps=-1, train_steps=-1, local_rank=-1, seed=42, early_stop_threshold=3)
Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, model_name: Salesforce/codet5p-220m
model created!
Total 223 training instances 
***** Running training *****
  Num examples = 223
  Batch size = 8
  Num epoch = 10

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 0
  eval_ppl = 1.00106
  global_step = 29
  train_loss = 0.4985
  ********************
Previous best ppl:inf
Achieve Best ppl:1.00106
  ********************
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 90.78 	 Previous best codebleu 0
  ********************
 Achieve Best bleu:90.78
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 1
  eval_ppl = 1.00061
  global_step = 57
  train_loss = 0.1223
  ********************
Previous best ppl:1.00106
Achieve Best ppl:1.00061
  ********************
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 93.29 	 Previous best codebleu 90.78
  ********************
 Achieve Best bleu:93.29
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 2
  eval_ppl = 1.00061
  global_step = 85
  train_loss = 0.062
  ********************
Previous best ppl:1.00061
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 94.41 	 Previous best codebleu 93.29
  ********************
 Achieve Best bleu:94.41
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 3
  eval_ppl = 1.0006
  global_step = 113
  train_loss = 0.0356
  ********************
Previous best ppl:1.00061
Achieve Best ppl:1.0006
  ********************
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 94.36 	 Previous best codebleu 94.41
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 4
  eval_ppl = 1.00064
  global_step = 141
  train_loss = 0.0265
  ********************
Previous best ppl:1.0006
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 94.76 	 Previous best codebleu 94.41
  ********************
 Achieve Best bleu:94.76
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 5
  eval_ppl = 1.00065
  global_step = 169
  train_loss = 0.0197
  ********************
Previous best ppl:1.0006
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 94.82 	 Previous best codebleu 94.76
  ********************
 Achieve Best bleu:94.82
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 6
  eval_ppl = 1.00065
  global_step = 197
  train_loss = 0.0146
  ********************
Previous best ppl:1.0006
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 94.32 	 Previous best codebleu 94.82
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 7
  eval_ppl = 1.00066
  global_step = 225
  train_loss = 0.0114
  ********************
Previous best ppl:1.0006
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 95.18 	 Previous best codebleu 94.82
  ********************
 Achieve Best bleu:95.18
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 8
  eval_ppl = 1.00068
  global_step = 253
  train_loss = 0.0097
  ********************
Previous best ppl:1.0006
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 94.83 	 Previous best codebleu 95.18
  ********************

***** Running evaluation *****
  Num examples = 27
  Batch size = 4
  epoch = 9
  eval_ppl = 1.00068
  global_step = 281
  train_loss = 0.0085
  ********************
Previous best ppl:1.0006
BLEU file: ./data/sstubs/3/validation.jsonl
  codebleu-4 = 94.83 	 Previous best codebleu 95.18
  ********************
reload model from sstubs/3/finetune_codet5p_220m/checkpoint-best-bleu
BLEU file: ./data/sstubs/3/test.jsonl
  codebleu = 94.56 
  Total = 27 
  Exact Fixed = 15 
[1, 4, 5, 6, 7, 8, 10, 11, 12, 16, 22, 23, 25, 26, 27]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  ********************
  Total = 27 
  Exact Fixed = 15 
[1, 4, 5, 6, 7, 8, 10, 11, 12, 16, 22, 23, 25, 26, 27]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  codebleu = 94.56 
[1.0, 0.881869732718652, 0.9548431641738979, 1.0, 1.0, 1.0, 1.0, 1.0, 0.936752055107628, 1.0, 1.0, 1.0, 0.8977573831682686, 0.963531800540206, 0.7888431522760508, 1.0, 0.8648103351245982, 0.8086995567252285, 0.9490051755223876, 0.9543920430664012, 0.8459152611805056, 1.0, 1.0, 0.685031966343737, 1.0, 1.0, 1.0]
Finish training and take 4m
Namespace(log_name='./sstubs/1/finetune_codet5p_220m.log', model_name='Salesforce/codet5p-220m', lang='java', output_dir='sstubs/1/finetune_codet5p_220m', data_dir='./data/sstubs/1', no_cuda=False, visible_gpu='0', add_task_prefix=False, add_lang_ids=False, num_train_epochs=10, num_test_epochs=10, train_batch_size=8, eval_batch_size=4, gradient_accumulation_steps=2, load_model_path=None, config_name='', tokenizer_name='', max_source_length=512, max_target_length=512, warm_up_ratio=0.1, do_train=True, do_eval=True, do_test=True, do_lower_case=False, learning_rate=5e-05, beam_size=10, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, eval_steps=-1, train_steps=-1, local_rank=-1, seed=42, early_stop_threshold=3)
Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, model_name: Salesforce/codet5p-220m
model created!
Total 260 training instances 
***** Running training *****
  Num examples = 260
  Batch size = 8
  Num epoch = 10

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 0
  eval_ppl = 1.00053
  global_step = 33
  train_loss = 0.4737
  ********************
Previous best ppl:inf
Achieve Best ppl:1.00053
  ********************
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 92.46 	 Previous best codebleu 0
  ********************
 Achieve Best bleu:92.46
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 1
  eval_ppl = 1.00041
  global_step = 65
  train_loss = 0.1044
  ********************
Previous best ppl:1.00053
Achieve Best ppl:1.00041
  ********************
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 93.58 	 Previous best codebleu 92.46
  ********************
 Achieve Best bleu:93.58
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 2
  eval_ppl = 1.00039
  global_step = 97
  train_loss = 0.0576
  ********************
Previous best ppl:1.00041
Achieve Best ppl:1.00039
  ********************
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 94.62 	 Previous best codebleu 93.58
  ********************
 Achieve Best bleu:94.62
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 3
  eval_ppl = 1.00041
  global_step = 129
  train_loss = 0.034
  ********************
Previous best ppl:1.00039
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 95.12 	 Previous best codebleu 94.62
  ********************
 Achieve Best bleu:95.12
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 4
  eval_ppl = 1.00043
  global_step = 161
  train_loss = 0.0241
  ********************
Previous best ppl:1.00039
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 95.12 	 Previous best codebleu 95.12
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 5
  eval_ppl = 1.00044
  global_step = 193
  train_loss = 0.0153
  ********************
Previous best ppl:1.00039
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 95.12 	 Previous best codebleu 95.12
  ********************

***** Running evaluation *****
  Num examples = 32
  Batch size = 4
  epoch = 6
  eval_ppl = 1.00045
  global_step = 225
  train_loss = 0.0113
  ********************
Previous best ppl:1.00039
BLEU file: ./data/sstubs/1/validation.jsonl
  codebleu-4 = 95.12 	 Previous best codebleu 95.12
  ********************
reload model from sstubs/1/finetune_codet5p_220m/checkpoint-best-bleu
BLEU file: ./data/sstubs/1/test.jsonl
  codebleu = 94.28 
  Total = 32 
  Exact Fixed = 18 
[5, 6, 8, 10, 15, 16, 19, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  ********************
  Total = 32 
  Exact Fixed = 18 
[5, 6, 8, 10, 15, 16, 19, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
  Syntax Fixed = 0 
[]
  Cleaned Fixed = 0 
[]
  codebleu = 94.28 
[0.8824709043482357, 0.9370576952964131, 0.940387748772268, 0.8700625454538655, 1.0, 1.0, 0.7308217159428345, 1.0, 0.9546221339246326, 1.0, 0.9383022364276514, 0.8107613352737074, 0.6772264301009557, 0.9269395879040603, 1.0, 1.0, 0.9372561368734473, 0.9136815104017959, 1.0, 0.7016265496309229, 0.9493239030379825, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
Finish training and take 6m
